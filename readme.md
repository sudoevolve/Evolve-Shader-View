

# Evolve Shader Viewer

A minimal **Shadertoy-like shader viewer** written in C++ with OpenGL 3.3 and GLFW.  
Supports both shaders with textures (`iChannel0`) and shaders without textures. Provides realtime rendering with mouse interaction and FPS display.


## Example Screenshot
![Example Shader](screenshot2.png)
![Example Shader](screenshot1.png)

---

# **ä½¿ç”¨æ–‡æ¡£**

---

## ğŸ“Œ ç®€ä»‹

``Evolve Shader Vieweræ˜¯ä¸€ä¸ªåŸºäº OpenGL çš„å¤šé€šé“ç€è‰²å™¨æ¸²æŸ“ç¨‹åºï¼Œçµæ„Ÿæ¥æºäº [Shadertoy](https://www.shadertoy.com/)ã€‚å®ƒæ”¯æŒåŠ è½½å¤šä¸ª `.frag` ç‰‡æ®µç€è‰²å™¨æ–‡ä»¶ï¼Œå¹¶é€šè¿‡äº¤äº’å¼é…ç½®å®ç°å¤æ‚çš„å¤šé€šé“æ¸²æŸ“ï¼ˆå¦‚åå¤„ç†ã€åé¦ˆã€å›¾åƒè¾“å…¥ç­‰ï¼‰ã€‚

è¯¥ç¨‹åºå…è®¸ç”¨æˆ·ï¼š
- è‡ªå®šä¹‰æ¯ä¸ªç€è‰²å™¨å¯¹å…¶ä»–ç¼“å†²åŒºæˆ–å›¾åƒçš„ä¾èµ–ã€‚
- æ”¯æŒå…¨å±€å›¾ç‰‡èµ„æºä½œä¸º `iChannel` è¾“å…¥ã€‚
- å®ç°è‡ªåé¦ˆï¼ˆfeedbackï¼‰ã€é“¾å¼æ¸²æŸ“ã€HDR è¾“å‡ºç­‰åŠŸèƒ½ã€‚

---

## ğŸ§° è¿è¡Œç¯å¢ƒè¦æ±‚

- æ“ä½œç³»ç»Ÿï¼šWindows / Linux / macOS
- æ˜¾å¡ï¼šæ”¯æŒ OpenGL 3.3 åŠä»¥ä¸Šç‰ˆæœ¬
- ç¼–è¯‘å™¨ï¼šæ”¯æŒ C++17 çš„ç¼–è¯‘å™¨ï¼ˆå¦‚ GCC, Clang, MSVCï¼‰
- ç¬¬ä¸‰æ–¹åº“ï¼š
  - GLFW
  - GLAD
  - STB Imageï¼ˆå†…åµŒï¼‰

> âœ… æ¨èä½¿ç”¨ç°ä»£æ˜¾å¡é©±åŠ¨ä»¥è·å¾—æœ€ä½³æ€§èƒ½ä¸å…¼å®¹æ€§ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„

è¿è¡Œæœ¬ç¨‹åºå‰ï¼Œè¯·ç¡®ä¿é¡¹ç›®ç›®å½•ä¸‹æœ‰ä»¥ä¸‹ä¸¤ä¸ªå…³é”®å­ç›®å½•ï¼š

```
project_root/
â”œâ”€â”€ main.cpp
â”œâ”€â”€ glad/          # GLAD å¤´æ–‡ä»¶å’Œæºç 
â”œâ”€â”€ GLFW/          # GLFW åº“é“¾æ¥
â”œâ”€â”€ stb_image.h    # å›¾åƒåŠ è½½å¤´æ–‡ä»¶
â”‚
â”œâ”€â”€ frag/          # å­˜æ”¾ .frag ç€è‰²å™¨ç‰‡æ®µæ–‡ä»¶
â”‚   â”œâ”€â”€ 0_base.frag
â”‚   â”œâ”€â”€ 1_blur.frag
â”‚   â””â”€â”€ 2_feedback.frag
â”‚
â””â”€â”€ iChannel/      # å­˜æ”¾å¯è¢«ç”¨ä½œçº¹ç†è¾“å…¥çš„å›¾åƒæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
    â”œâ”€â”€ photo.jpg
    â””â”€â”€ textures/pattern.png
```

---

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šå‡†å¤‡ç€è‰²å™¨æ–‡ä»¶

å°†ä½ çš„ GLSL ç‰‡æ®µç€è‰²å™¨ä¿å­˜ä¸º `.frag` æ–‡ä»¶ï¼Œæ”¾å…¥ `frag/` ç›®å½•ä¸­ï¼Œå‘½åå»ºè®®å¸¦ç¼–å·ä»¥ä¾¿æ’åºï¼š

```glsl
// frag/0_base.frag
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    fragColor = vec4(uv, 0.5 + 0.5 * sin(iTime), 1.0);
}
```

> âš ï¸ æ³¨æ„ï¼šä¸éœ€è¦å†™ `main()` å‡½æ•°ä¸»ä½“ï¼Œåªéœ€å®šä¹‰ `mainImage(out vec4, in vec2)` å³å¯ã€‚

### æ­¥éª¤ 2ï¼šç¼–è¯‘å¹¶è¿è¡Œç¨‹åº


> åœ¨ Windows ä¸Šå¯ä½¿ç”¨ Visual Studio æˆ– MinGW é…åˆç›¸åº”åº“è¿›è¡Œæ„å»ºã€‚

---

## ğŸ”§ ç¨‹åºå¯åŠ¨æµç¨‹

1. **æ‰«æ `iChannel/` æ–‡ä»¶å¤¹ä¸­çš„å›¾åƒ**  
   æ‰€æœ‰ `.png`, `.jpg`, `.jpeg` æ–‡ä»¶ä¼šè¢«åˆ—å‡ºå¹¶å¯ç”¨äºåç»­ä½œä¸º `iChannel` è¾“å…¥ã€‚

2. **æ‰«æ `frag/` ä¸­çš„ `.frag` æ–‡ä»¶**  
   æŒ‰æ–‡ä»¶åä¸­çš„æ•°å­—è‡ªåŠ¨æ’åºï¼ˆä¾‹å¦‚ `0_main.frag`, `1_blur.frag` â†’ æŒ‰åºæ‰§è¡Œï¼‰ã€‚

3. **è¿›å…¥äº¤äº’å¼é…ç½®æ¨¡å¼**

   å¯åŠ¨æ—¶ä¼šæç¤ºä½ é…ç½®æ¯ä¸ª pass çš„ `iChannel0 ~ iChannel3` è¾“å…¥æ¥æºï¼š

   ```
   === Interactive iChannel Setup ===
    Press Enter for auto-chain (buffer0 â†’ buffer1 â†’ ...),
    or type a buffer index to configure manually: 
   ```

   - ç›´æ¥å›è½¦ â†’ å¯ç”¨â€œè‡ªåŠ¨é“¾å¼â€ï¼šæ¯ä¸ª pass é»˜è®¤ä»ä¸Šä¸€ä¸ª pass è·å–è¾“å‡ºï¼ˆ`buffer[n-1] â†’ buffer[n]`ï¼‰ã€‚
   - è¾“å…¥ç¼–å·ï¼ˆå¦‚ `1`ï¼‰â†’ æ‰‹åŠ¨é…ç½®è¯¥ pass çš„æ‰€æœ‰ channel è¾“å…¥ã€‚

---

## ğŸ® äº¤äº’å¼é…ç½®è¯´æ˜

å½“ä½ è¾“å…¥ä¸€ä¸ª Pass ç¼–å·åï¼Œç³»ç»Ÿä¼šè®©ä½ ä¸ºå®ƒçš„å››ä¸ª `iChannel` åˆ†åˆ«é€‰æ‹©è¾“å…¥æºï¼š

```text
Configuring buffer1 (blur.frag):
iChannel0 source:
  1: none
  2: self (feedback)
  3: buffer0
  4+: image (see global list below)
> 
```

é€‰é¡¹å«ä¹‰å¦‚ä¸‹ï¼š

| é€‰é¡¹ | å«ä¹‰ |
|------|------|
| `1` | ä¸è¿æ¥ä»»ä½•è¾“å…¥ï¼ˆé»‘å›¾ï¼‰ |
| `2` | ä½¿ç”¨å½“å‰ pass è‡ªèº«çš„å‰ä¸€å¸§è¾“å‡ºï¼ˆç”¨äºåé¦ˆæ•ˆæœï¼‰ |
| `3~N+2` | ä½¿ç”¨å‰é¢æŸä¸ª pass çš„è¾“å‡ºç¼“å†²åŒºï¼ˆå¦‚ `buffer0`ï¼‰ |
| `N+3+` | ä½¿ç”¨ `iChannel/` ä¸­çš„å›¾åƒæ–‡ä»¶ |

ç¤ºä¾‹ï¼šè‹¥ä½ æœ‰ 2 ä¸ª shaderï¼Œåˆ™ `buffer0` å’Œ `buffer1` å­˜åœ¨ï¼›è‹¥ `iChannel` åˆ—è¡¨ä¸­æœ‰ 3 å¼ å›¾ï¼Œåˆ™å›¾åƒç´¢å¼•ä» `(base=5)` å¼€å§‹ã€‚

> ğŸ’¡ æç¤ºï¼šä½ å¯ä»¥ä¸­é€”è·³è¿‡å‰©ä½™ channels çš„è®¾ç½®ã€‚

å®Œæˆæ‰€æœ‰æ‰‹åŠ¨é…ç½®åï¼ŒæŒ‰å›è½¦é€€å‡ºé…ç½®æ¨¡å¼ã€‚

> âœ… è‹¥æŸ Pass å®Œå…¨æœªé…ç½®ä»»ä½• channelï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å°†å…¶ `iChannel0` è®¾ä¸ºå‰ä¸€ä¸ª pass çš„è¾“å‡ºã€‚

---

## ğŸ¨ åŠŸèƒ½ç‰¹æ€§è¯¦è§£

### âœ… å¤šé€šé“æ¸²æŸ“ï¼ˆMulti-pass Renderingï¼‰

æ¯ä¸ª `.frag` æ–‡ä»¶ä»£è¡¨ä¸€ä¸ªæ¸²æŸ“ passï¼Œé¡ºåºæ‰§è¡Œå¹¶å°†ç»“æœå†™å…¥ FBOï¼ˆæµ®ç‚¹çº¹ç†ï¼‰ï¼Œæœ€åä¸€ä¸ª pass è¾“å‡ºåˆ°å±å¹•ã€‚

- æ”¯æŒæœ€å¤š N ä¸ª passesï¼ˆå–å†³äº `.frag` æ–‡ä»¶æ•°é‡ï¼‰ã€‚
- ä¸­é—´ç¼“å†²åŒºæ ¼å¼ä¸º `GL_RGBA16F`ï¼ˆåŠç²¾åº¦æµ®ç‚¹ï¼‰ï¼Œæ”¯æŒ HDR æ¸²æŸ“ã€‚

### âœ… å…¨å±€å›¾åƒè¾“å…¥ï¼ˆiChannel from Filesï¼‰

æ‰€æœ‰ `iChannel/*.png/.jpg` å›¾åƒå¯åœ¨é…ç½®ä¸­ä½œä¸º `iChannel` è¾“å…¥ä½¿ç”¨ã€‚

- è·¯å¾„ç¼“å­˜é¿å…é‡å¤åŠ è½½ã€‚
- æ”¯æŒå­ç›®å½•ç»“æ„ã€‚
- è‡ªåŠ¨ç¿»è½¬ Y è½´ï¼ˆé€‚é… OpenGL åæ ‡ç³»ï¼‰ã€‚

### âœ… Shadertoy å…¼å®¹è¯­æ³•

ä½ å†™çš„ `.frag` æ–‡ä»¶å¯ä»¥ç›´æ¥ç§»æ¤è‡ª Shadertoyï¼Œæ”¯æŒä»¥ä¸‹ uniformï¼š

| Uniform         | ç±»å‹       | æè¿° |
|------------------|------------|------|
| `iResolution`   | `vec3`     | å½“å‰åˆ†è¾¨ç‡ï¼ˆxyï¼‰å’Œ dpi ç¼©æ”¾ï¼ˆzï¼‰ |
| `iTime`         | `float`    | è‡ªå¯åŠ¨ä»¥æ¥çš„æ—¶é—´ï¼ˆç§’ï¼‰ |
| `iTimeDelta`    | `float`    | ä¸Šä¸€å¸§æ—¶é—´é—´éš” |
| `iFrame`        | `int`      | å¸§è®¡æ•°å™¨ |
| `iMouse`        | `vec4`     | é¼ æ ‡ä½ç½® `(x,y,down,_)` |
| `iChannel0~3`   | `sampler2D`| çº¹ç†è¾“å…¥ |
| `iChannelResolution[4]` | `vec3[]` | æ¯ä¸ª channel çš„åˆ†è¾¨ç‡ä¿¡æ¯ |

### âœ… è‡ªåé¦ˆï¼ˆFeedback Effectsï¼‰

å¯ç”¨ `iChannel` ç±»å‹ä¸º â€œselfâ€ å¯å®ç°å»¶è¿Ÿåé¦ˆæ•ˆæœï¼ˆå¦‚å…‰ trailsã€é€’å½’æ¨¡ç³Šï¼‰ï¼š

```glsl
// ç¤ºä¾‹ï¼šåé¦ˆæ··åˆ
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    vec4 prev = texture(iChannel0, uv); // self feedback
    vec4 current = /* some new color */;
    fragColor = mix(current, prev, 0.95); // æ®‹å½±æ•ˆæœ
}
```

> âš ï¸ æ³¨æ„ï¼šé¦–æ¬¡è¿è¡Œæ—¶ feedback å†…å®¹ä¸ºç©ºï¼ˆé»‘å±ï¼‰ï¼Œéœ€å‡ å¸§æ‰èƒ½å»ºç«‹çŠ¶æ€ã€‚

### âœ… sRGB æ”¯æŒ

å¯ç”¨çª—å£ sRGB æ¨¡å¼ï¼Œä¿è¯é¢œè‰²æ­£ç¡®æ˜¾ç¤ºï¼š

```cpp
glfwWindowHint(GLFW_SRGB_CAPABLE, GLFW_TRUE);
...
if (glfwGetWindowAttrib(window, GLFW_SRGB_CAPABLE)) {
    glEnable(GL_FRAMEBUFFER_SRGB);
}
```

---

## ğŸ–±ï¸ ç”¨æˆ·äº¤äº’

| æ“ä½œ             | æ•ˆæœ |
|------------------|------|
| ç§»åŠ¨é¼ æ ‡         | æ›´æ–° `iMouse.xy` å€¼ |
| å·¦é”®ç‚¹å‡»         | è®¾ç½® `iMouse.z = 1.0`ï¼ˆæŒ‰ä¸‹çŠ¶æ€ï¼‰ |
| çª—å£å¤§å°æ”¹å˜     | è‡ªåŠ¨é‡å»ºæ‰€æœ‰ FBO å¹¶è°ƒæ•´è§†å£ |
| å…³é—­çª—å£         | å®‰å…¨é‡Šæ”¾èµ„æºå¹¶é€€å‡º |

FPS æ˜¾ç¤ºåœ¨çª—å£æ ‡é¢˜æ ä¸­ï¼ˆæ¯ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰ã€‚

---

## ğŸ“‚ æ–‡ä»¶å‘½åè§„èŒƒå»ºè®®

ä¸ºäº†æ­£ç¡®æ’åºï¼Œè¯·ä½¿ç”¨å¦‚ä¸‹æ ¼å¼å‘½å `.frag` æ–‡ä»¶ï¼š

```
0_base.frag
1_blur.frag
2_feedback.frag
...
```

> âŒ é”™è¯¯ç¤ºä¾‹ï¼š`blur.frag`, `effect.frag` â†’ æ— æ³•ç¡®å®šæ‰§è¡Œé¡ºåºï¼

---

## ğŸ§ª è°ƒè¯•æŠ€å·§

- è‹¥å‡ºç°ç€è‰²å™¨ç¼–è¯‘é”™è¯¯ï¼Œç¨‹åºä¼šæ‰“å°è¯¦ç»†æ—¥å¿—åˆ°æ§åˆ¶å°ã€‚
- è‹¥çº¹ç†åŠ è½½å¤±è´¥ï¼Œä¼šè¿”å›ä¸€å¼ é»‘è‰²å ä½å›¾ï¼ˆä¸å½±å“è¿è¡Œï¼‰ã€‚
- FBO åˆ›å»ºå¤±è´¥é€šå¸¸æ˜¯å› ä¸ºæ˜¾å¡ä¸æ”¯æŒ `GL_RGBA16F` æ ¼å¼ï¼ˆæå°‘è§ï¼‰ã€‚

---

## ğŸ“ ç¤ºä¾‹é¡¹ç›®ç»“æ„

```
demo_project/
â”œâ”€â”€ frag/
â”‚   â”œâ”€â”€ 0_noise.frag
â”‚   â”œâ”€â”€ 1_blur.frag
â”‚   â””â”€â”€ 2_composite.frag
â”œâ”€â”€ iChannel/
â”‚   â”œâ”€â”€ tex_wood.jpg
â”‚   â””â”€â”€ logo.png
â””â”€â”€ renderer.exe
```

å‡è®¾ï¼š
- `0_noise.frag` ç”ŸæˆåŠ¨æ€å™ªå£°ï¼›
- `1_blur.frag` å¯¹ `buffer0` åšé«˜æ–¯æ¨¡ç³Šï¼›
- `2_composite.frag` å°†æ¨¡ç³Šå±‚ä¸åŸå§‹å™ªå£°å åŠ ã€‚

é…ç½®æ–¹å¼ï¼š
- `buffer1`: `iChannel0 = buffer0`
- `buffer2`: `iChannel0 = buffer0`, `iChannel1 = buffer1`

å³å¯å®ç°å¤åˆè§†è§‰æ•ˆæœã€‚

---

## ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚ç¬¬ä¸‰æ–¹ä¾èµ–è¯·éµå¾ªå…¶å„è‡ªåè®®ï¼š

- [GLFW](https://www.glfw.org/license.html) â€“ zlib/libpng è®¸å¯è¯
- [GLAD](https://github.com/Dav1dde/glad) â€“ MIT
- [stb_image.h](https://github.com/nothings/stb) â€“ Public Domain

---

## ğŸ™Œ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- GLFW â€“ çª—å£ä¸è¾“å…¥ç®¡ç†
- GLAD â€“ OpenGL æ‰©å±•åŠ è½½
- STB â€“ ç®€å•é«˜æ•ˆçš„å›¾åƒè§£ç 
- Shadertoy â€“ åˆ›æ„çµæ„Ÿæ¥æº

---

ğŸ‘‰ **Happy Coding & Evolving Shaders!**
